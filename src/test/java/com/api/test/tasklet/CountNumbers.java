package com.api.test.tasklet;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashSet;
import java.util.List;
import java.util.Set;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import org.junit.Test;

/**
 * Why are there so many invited users with permission random shopper instead of invited shopper?
 * 
 * There are 698 total random users in the user_access table.
 * 
 * Questions:
 * 
 * 1.  How many random shoppers were invited but not referred?
 * 		select invited and referred and how many is in one but not the other list
 * 2.  How many random shoppers were referred but not invited?
 * 		select invited and referred and how many is in one but not the other list
 * 3.  How many random shoppers were invited and referred
 * 		get the user list from invited and see if they are also in the same list as the referred
 * 4.  How many inviters are also referrers? 
 * 		21 records and of the 21, user_id = 184 does not have a user account but only invited 1 user which is record 185
 * 
 * 		200, Henry, Homsher, hhomsher@msn.com
 * 		241, Philip, Righter, philiprighter@gmail.com
		336, Gzurjuan, Fears-Neal, gzurjuan@gmail.com
		348, Gaby, Raileanu, raileanu2018@lawnet.ucla.edu
		446, Samuel, Campbell, Samuel.campbell@sbcglobal.net
		463, Shahram, Ghandeharizadeh, shahram_ghandeharizadeh@yahoo.com
		466, Jonathan, Williams, jwjw22@yahoo.com
		495, Lawrence, Bostic, lbostic12@gmail.com
		505, Salley, Kim, salleykim@gmail.com
		728, Matthew, Driver, rawrimazombie@gmail.com
		779, ryan, Blackstock, ryan@thexanadulife.com
		841, Mimi, Schirm, mimischirm@gmail.com
		941, Erol, Thompson Jr, erolthompsonjr@gmail.com
		1183, Fernando, Aguilar, aguilar-47@hotmail.com
	5.  How many inviters?
	6.  How many invitors have no user records?
	7.  How many referrers?
	8.  How many referrers have no user records?
	9.  How many random shoppers have no user records?
		692 user records found out of the 698 random shopper users.  Missing 6 user accounts
		SELECT * FROM clout_v1_3.users where id in (44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252);
	10. How many random shoppers were referred?
		265 random shoppers were referred.
		SELECT count(*) FROM clout_v1_3.referrals where _user_id in (44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252);
	11. How many random shoppers were invited?
		407 random shoppers were invited.  Same random shopper were invited multiple times where their email address were unique but the user id were the same in the message_invites
		SELECT * FROM clout_v1_3msg.message_invites where _user_id in (44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252)
		103,103,103,103,103,128,128,128,128,128,174,181,181,181,181,181,190,200,200,200,200,200,202,202,202,208,221,222,222,222,222,222,223,223,223,223,223,239,239,239,239,239,239,241,241,241,241,241,241,283,283,283,283,283,283,334,334,334,334,334,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,348,348,348,348,348,374,374,374,374,374,390,390,390,390,390,392,392,392,409,409,409,409,409,415,415,415,415,415,445,445,445,445,445,446,446,446,446,446,463,463,463,463,463,466,466,466,466,466,466,475,475,475,475,475,487,487,487,487,487,494,494,494,494,494,495,495,495,495,495,495,495,495,495,495,505,505,505,505,505,588,588,588,588,588,601,601,601,601,601,623,623,623,623,623,625,625,625,625,625,692,692,692,692,692,712,712,712,712,712,728,728,728,728,728,729,729,729,729,729,752,752,752,752,752,752,757,757,757,757,757,759,759,759,759,759,779,779,779,779,779,779,791,791,791,791,791,793,793,793,793,793,794,794,794,794,794,798,801,801,801,801,801,813,813,813,813,813,818,818,818,818,818,825,825,825,825,825,828,828,828,828,828,840,840,840,840,840,841,841,841,841,841,841,857,857,857,857,857,859,859,859,859,859,859,864,864,864,864,864,864,877,877,877,877,877,881,881,881,881,881,901,901,901,901,901,905,905,905,905,905,912,912,912,912,912,916,916,916,916,916,920,920,941,941,941,941,941,941,942,942,942,942,942,944,944,944,944,944,955,955,955,955,955,977,977,977,977,977,1005,1005,1005,1005,1005,1010,1010,1010,1010,1010,1010,1010,1010,1010,1017,1017,1017,1017,1017,1048,1048,1048,1048,1048,1103,1103,1103,1103,1103,1123,1123,1123,1123,1123,1123,1123,1124,1165,1165,1165,1165,1165,1167,1167,1167,1167,1167,1183,1183,1183,1183,1183,1183,1223,1223,1223,1223,1223
	12. How many random shoppers are accurate?  How many are not in both referred and not in invites?
		
	
These users with "random shopper" group should have been "invited shopper" because they've invited over 5 users (841, 336)

The others may be legitimate because the rules has to be turned on for the invited user to go from "random shopper" to invited shopper upon signing up

1, 200
1, 241
17, 336
1, 348
1, 446
1, 463
1, 466
1, 495
1, 505
1, 728
1, 779
5, 841
1, 941
1, 1183

	
 * 
 * referred by 184 a user that does not exist in the user table
 * 
 * 185, 6, rgill50@gmail.com, 5052da21534209726ddf2b3dd72c46d6b68475c7, , , 2015-12-15 05:55:19
 * 
 * @author Ung
 *
 */
public class CountNumbers {

	/*
	 * These users are not invited or referred and they have random shopper permission which is corret
	 */
	private final static String accurateRandomShoppers = "1220,1216,1215,1214,1213,918,1107,1227,1225,1101,1221,800,922,802,926,1229,809,1000,1121,1240,1239,1238,1116,1237,1115,1235,1112,1232,814,935,815,816,819,1131,1252,1130,1251,1129,1128,1127,1125,1246,700,1001,1122,1243,701,822,823,946,826,948,707,1009,709,1021,1137,950,951,1134,711,953,1133,714,956,716,837,717,718,719,1154,961,962,1025,721,963,1024,964,724,966,725,967,968,727,969,1044,1164,1163,1162,1039,1158,1036,1157,732,974,1156,733,854,734,735,856,738,739,1176,1052,1173,1051,1170,980,860,982,1049,741,1169,500,863,1168,1046,744,1045,1166,866,867,868,748,749,1187,1186,1185,1182,870,871,992,751,872,631,994,753,874,1179,754,875,1178,1177,635,878,999,758,879,1076,1197,1195,1071,1070,761,882,762,400,763,884,401,885,402,1189,403,887,404,767,888,405,889,406,408,1088,1085,890,891,892,772,410,773,894,774,895,412,775,896,897,1079,777,1078,416,417,418,419,1091,1099,1097,1096,1095,1094,1093,780,781,782,420,662,421,663,422,664,423,544,424,425,788,426,427,669,307,429,790,670,792,310,432,555,556,677,315,678,316,317,442,201,322,203,324,687,204,205,326,206,327,207,328,329,330,331,211,332,453,212,333,213,214,335,215,699,216,337,458,217,338,339,460,340,582,220,583,342,101,343,465,586,224,345,587,225,346,226,347,227,351,352,473,477,236,478,237,479,238,118,119,240,483,122,364,123,365,124,366,125,367,488,126,368,489,369,249,129,370,491,492,130,373,253,133,254,496,134,135,256,498,136,378,137,138,259,139,380,260,261,383,384,385,386,388,147,389,148,149,44,391,150,151,393,153,154,396,155,397,156,398,157,399,158,159,160,161,282,162,163,284,164,165,286,166,167,169,173,295,175,296,176,177,178,179,180,182,183,186,187,188,191,195,196,197,198,199,1206,1203,906";
	
	// SELECT user_id FROM clout_v1_3iam.user_access where permission_group_id = 6
	private final static String userIdsWithRandomShopperPermission = "44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252";

	// SELECT _user_id FROM clout_v1_3.referrals where  _user_id in(44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252)
	private final static String userIdsFromReferralTable = "185,231,247,285,314,323,336,344,348,349,355,356,377,387,390,394,395,413,414,415,428,430,445,446,452,455,456,459,462,464,466,467,468,469,471,474,475,476,480,481,482,484,485,486,487,490,493,494,495,499,501,502,503,517,585,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,636,637,638,651,652,655,656,658,659,661,666,668,673,674,675,676,679,680,681,683,685,688,690,691,693,694,695,698,702,703,704,705,708,710,712,715,720,722,723,726,731,736,737,742,743,745,746,747,750,752,757,759,760,764,765,766,770,783,784,785,786,787,789,791,793,795,796,797,801,804,805,806,808,811,818,820,821,824,825,827,828,829,830,831,832,833,834,835,836,839,840,841,842,843,844,845,846,847,848,849,850,851,852,857,859,861,864,865,869,873,876,877,880,881,886,898,899,900,901,902,903,904,905,907,908,909,910,911,913,915,916,917,919,920,921,924,925,927,928,929,931,932,933,934,936,940,941,942,943,944,945,947,955,958,959,960,965,971,972,983,990,1028,1061,1062,1066,1073,1084,1089,1092,1098,1105,1117,1118,1119,1120,1126,1135,1136,1140,1148,1159,1174,1191,1212,1236,1244,1247";

	// SELECT _user_id FROM clout_v1_3msg.message_invites where _user_id in (44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252);	
	private final static String userIdsFromMessageInvitesTable = "103,103,103,103,103,128,128,128,128,128,174,181,181,181,181,181,190,200,200,200,200,200,202,202,202,208,221,222,222,222,222,222,223,223,223,223,223,239,239,239,239,239,239,241,241,241,241,241,241,283,283,283,283,283,283,334,334,334,334,334,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,336,348,348,348,348,348,374,374,374,374,374,390,390,390,390,390,392,392,392,409,409,409,409,409,415,415,415,415,415,445,445,445,445,445,446,446,446,446,446,463,463,463,463,463,466,466,466,466,466,466,475,475,475,475,475,487,487,487,487,487,494,494,494,494,494,495,495,495,495,495,495,495,495,495,495,505,505,505,505,505,588,588,588,588,588,601,601,601,601,601,623,623,623,623,623,625,625,625,625,625,692,692,692,692,692,712,712,712,712,712,728,728,728,728,728,729,729,729,729,729,752,752,752,752,752,752,757,757,757,757,757,759,759,759,759,759,779,779,779,779,779,779,791,791,791,791,791,793,793,793,793,793,794,794,794,794,794,798,801,801,801,801,801,813,813,813,813,813,818,818,818,818,818,825,825,825,825,825,828,828,828,828,828,840,840,840,840,840,841,841,841,841,841,841,857,857,857,857,857,859,859,859,859,859,859,864,864,864,864,864,864,877,877,877,877,877,881,881,881,881,881,901,901,901,901,901,905,905,905,905,905,912,912,912,912,912,916,916,916,916,916,920,920,941,941,941,941,941,941,942,942,942,942,942,944,944,944,944,944,955,955,955,955,955,977,977,977,977,977,1005,1005,1005,1005,1005,1010,1010,1010,1010,1010,1010,1010,1010,1010,1017,1017,1017,1017,1017,1048,1048,1048,1048,1048,1103,1103,1103,1103,1103,1123,1123,1123,1123,1123,1123,1123,1124,1165,1165,1165,1165,1165,1167,1167,1167,1167,1167,1183,1183,1183,1183,1183,1183,1223,1223,1223,1223,1223";

	private final static Set<String> accurateRandomShoppersIds = new HashSet<String>();
	private final static Set<String> userIdsWithRandomShopperPermissionIds = new HashSet<String>();
	private final static Set<String> userIdsFromReferralTableIds = new HashSet<String>();
	private final static Set<String> userIdsFromMessageInvitesTableIds = new HashSet<String>();
	
	static {
		String[] temp = accurateRandomShoppers.split(",");
		Arrays.asList(temp).stream().forEach(c -> accurateRandomShoppersIds.add(c.trim()));
		
		temp = userIdsWithRandomShopperPermission.split(",");
		Arrays.asList(temp).stream().forEach(userIdsWithRandomShopperPermissionIds::add);
		
		temp = userIdsFromReferralTable.split(",");
		Arrays.asList(temp).stream().forEach(userIdsFromReferralTableIds::add);
		
		temp = userIdsFromMessageInvitesTable.split(",");
		Arrays.asList(temp).stream().forEach(userIdsFromMessageInvitesTableIds::add);
	}
	
	/******** referrer and inviter info *********/
	// SELECT _referred_by FROM clout_v1_3.referrals where _user_id in(44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252)
	private final static String _ReferredByIds = "1183,184,241,495,276,463,100,200,277,288,234,279,466,841,336,446,941,348,779,505,728";
	
	// SELECT _invitation_sent_by FROM clout_v1_3msg.message_invites where _user_id in (44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252);
	private final static String _invitationSentBy = "190,390,392,1183,791,793,475,794,1017,752,798,239,712,877,757,955,912,759,916,283,241,881,200,487,202,840,1103,445,841,1223,446,128,601,920,801,208,409,728,729,1165,174,494,692,374,495,970,334,336,415,779,977,813,857,859,818,1010,181,221,463,222,981,223,1005,103,466,1048,588,864,941,1167,348,623,942,625,944,505,901,825,828,905";
	
	private final static Set<String> _ReferredByIdsList = new HashSet<String>();
	private final static Set<String> _invitationSentByList = new HashSet<String>();

	static {
		String[] temp = _ReferredByIds.split(",");
		Arrays.asList(temp).stream().forEach(_ReferredByIdsList::add);
		
		temp = _invitationSentBy.split(",");
		Arrays.asList(temp).stream().forEach(_invitationSentByList::add);
	}
	
	/*
	 * Are these referrers or inviters "random shopper"?  If so then data is correct
	 * find the permission of these user ids
	 * 
	 * Anyone invited by these guys should be permission_group_id = 5 too
	 * 
100, 5, dfugardi@gmail.com
234, 5, danfugardi@yahoo.com
276, 5, fmk@globalkorp.com
277, 5, fcesar481@me.com
279, 5, razo2u@gmail.com
288, 5, dmitry.romanyukha@gmail.com
970, 5, dwayneladd@gmail.com
981, 5, biancaker01@gmail.com

	 * 
	 * 
	 */
	
	/*
	 * How many random shoppers were invited but not referred?
	 * 
	 * 80 invited
	 * 40 of the 80 not referred
	 * 
	 * 912,1103,1223,813,1010,1005,1124,1123,1017,728,729,1165,977,1048,1167,505,1183,409,779,794,798,200,202,208,692,334,221,463,222,223,103,239,241,128,374,392,283,174,181,190
	 */
	@Test
	public void testCase1() {
		// not in invites list
		List<String> invitedUserIds = userIdsWithRandomShopperPermissionIds.stream().filter(p -> userIdsFromMessageInvitesTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("invited size " + invitedUserIds.size());
		

		// not referred
		List<String> noReferralUsersIds = invitedUserIds.stream().filter(p -> !userIdsFromReferralTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("but not referred " + noReferralUsersIds.size());
		
		noReferralUsersIds.stream().forEach(System.out::println);
	}
	
	/*
	 * How many random shoppers were referred but not invited?
	 * 
	 * referred 265
	 * not invited size 225
	 * 
	 * 907,908,909,1212,910,911,913,915,917,919,1105,921,924,804,925,805,806,927,928,808,929,1120,1118,1117,1236,931,811,932,933,934,936,1119,1126,1247,940,820,1244,821,943,702,703,824,945,704,705,947,827,708,829,1140,1136,830,1135,710,831,832,833,834,835,715,836,958,959,839,1028,960,1148,720,842,722,843,723,844,965,845,604,846,726,847,606,848,849,608,850,971,1159,851,972,610,731,852,611,612,614,615,736,616,737,617,618,619,1174,861,983,621,742,501,743,502,865,503,745,746,747,869,628,1066,1062,1061,990,750,630,873,876,636,637,517,638,1073,1191,880,760,764,765,886,766,1084,770,651,652,413,655,414,656,898,899,658,659,1098,1092,661,783,784,785,786,666,787,1089,668,789,428,430,673,674,795,675,796,676,797,314,679,680,681,683,685,323,688,690,691,693,452,694,695,455,456,698,459,462,464,585,344,467,468,589,469,349,591,471,593,231,474,355,476,356,599,480,481,482,484,485,486,247,490,493,377,499,387,394,395,285,185,900,902,903,904
	 */
	@Test
	public void testCase2() {

		//  referred
		List<String> referredUserIds = userIdsWithRandomShopperPermissionIds.stream().filter(p -> userIdsFromReferralTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("referred " + referredUserIds.size());
		
		// not invited
		List<String> referredButNotInvitedIds = referredUserIds.stream().filter(p -> !userIdsFromMessageInvitesTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		
		System.out.println("not invited size " + referredButNotInvitedIds.size());
		

		
		referredButNotInvitedIds.stream().forEach(System.out::println);
	}
	
	/*
	 * 
	 * referred 265
	 * invited or referred 305
	 * 
	 */
	@Test
	public void testReferredOrInvited() {
		//  referred
		List<String> referredUserIds = userIdsWithRandomShopperPermissionIds.stream().filter(p -> userIdsFromReferralTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("referred " + referredUserIds.size());
		
		// not invited
		List<String> invitedUserIds = userIdsWithRandomShopperPermissionIds.stream().filter(p -> userIdsFromMessageInvitesTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		// merge the 2 list
		List<String> mergedList = Stream.concat(referredUserIds.stream(), invitedUserIds.stream()).distinct().collect(Collectors.toList());

		System.out.println("invited or referred " + mergedList.size());

		mergedList.stream().forEach(System.out::println);
	}
	
	/*
	 * 618 has no invited users 
	 * 393 has no referral users and no invite users 
	 * 
	 * 393 of the 698 are accurate random shopper users
	 * 
	 * returns list of users with correct random shopper permission
	 */
	@Test
	public void testCase12() {
		// not in invites list
		List<String> noInvitedUsersIds = userIdsWithRandomShopperPermissionIds.stream().filter(p -> !userIdsFromMessageInvitesTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("has no invited users " + noInvitedUsersIds.size());
		

		// not referred
		List<String> noReferralUsersIds = noInvitedUsersIds.stream().filter(p -> !userIdsFromReferralTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("has no referral users and no invite users " + noReferralUsersIds.size());
		
		noReferralUsersIds.stream().forEach(System.out::println);
	}
	

	/**
	 * invited and referred
	 * 
	 * 80 invited
	 * 40 invited and referred
	 * 
	 * 916,920,801,818,941,942,944,825,828,712,955,840,841,601,857,859,864,623,625,752,877,757,759,881,415,791,793,445,446,336,466,588,348,475,487,494,495,390,901,905
	 * 
	 */
	@Test
	public void testCase3() {
		// in invites list
		List<String> noInvitedUsersIds = userIdsWithRandomShopperPermissionIds.stream().filter(p -> userIdsFromMessageInvitesTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("were invited " + noInvitedUsersIds.size());
		

		// referred
		List<String> noReferralUsersIds = noInvitedUsersIds.stream().filter(p -> userIdsFromReferralTableIds.contains(p))
		.collect(Collectors.toCollection(ArrayList::new));
		
		System.out.println("were invited and referred " + noReferralUsersIds.size());
		
		noReferralUsersIds.stream().forEach(System.out::println);
	}
	
	

	
	

	/*
	 * Analyze the referrer and the inviters
	 * 
	 * for given ids:
	 * 
	 * 44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252
	 */
	@Test
	public void testRemoveDuplicate() {
		// SELECT _referred_by FROM clout_v1_3.referrals where _user_id in(44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252)
		String _ReferredByIds = "184,241,200,279,276,276,276,276,348,276,276,276,276,276,276,277,277,276,276,276,234,276,336,336,336,446,276,276,336,288,336,288,276,276,463,276,276,276,276,276,276,276,276,276,276,276,276,336,336,336,276,276,276,505,288,276,336,336,336,276,276,336,276,276,276,276,276,336,276,276,276,276,276,276,276,276,276,276,276,276,276,336,276,336,276,336,276,495,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,728,276,276,276,276,100,276,276,276,466,276,276,276,276,276,276,276,276,779,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,336,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,841,276,841,841,841,841,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,941,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,276,1183,276,276,276,276";
		
		String[] theIds = _ReferredByIds.split(",");
		Set<String> uniqueIds = new HashSet<String>();
		
		Arrays.asList(theIds).stream().forEach(uniqueIds::add);
		
		//uniqueIds.stream().forEach(System.out::println);

		//System.out.println(uniqueIds.size());
		
		// SELECT _invitation_sent_by FROM clout_v1_3msg.message_invites where _user_id in (44,101,103,118,119,122,123,124,125,126,128,129,130,133,134,135,136,137,138,139,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,169,173,174,175,176,177,178,179,180,181,182,183,185,186,187,188,190,191,195,196,197,198,199,200,201,202,203,204,205,206,207,208,211,212,213,214,215,216,217,220,221,222,223,224,225,226,227,231,236,237,238,239,240,241,247,249,253,254,256,259,260,261,282,283,284,285,286,295,296,307,310,314,315,316,317,322,323,324,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,342,343,344,345,346,347,348,349,351,352,355,356,364,365,366,367,368,369,370,373,374,377,378,380,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,408,409,410,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,432,442,445,446,452,453,455,456,458,459,460,462,463,464,465,466,467,468,469,471,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,498,499,500,501,502,503,505,517,544,555,556,582,583,585,586,587,588,589,591,593,599,601,604,606,608,610,611,612,614,615,616,617,618,619,621,623,625,628,630,631,635,636,637,638,651,652,655,656,658,659,661,662,663,664,666,668,669,670,673,674,675,676,677,678,679,680,681,683,685,687,688,690,691,692,693,694,695,698,699,700,701,702,703,704,705,707,708,709,710,711,712,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,731,732,733,734,735,736,737,738,739,741,742,743,744,745,746,747,748,749,750,751,752,753,754,757,758,759,760,761,762,763,764,765,766,767,770,772,773,774,775,777,779,780,781,782,783,784,785,786,787,788,789,790,791,792,793,794,795,796,797,798,800,801,802,804,805,806,808,809,811,813,814,815,816,818,819,820,821,822,823,824,825,826,827,828,829,830,831,832,833,834,835,836,837,839,840,841,842,843,844,845,846,847,848,849,850,851,852,854,856,857,859,860,861,863,864,865,866,867,868,869,870,871,872,873,874,875,876,877,878,879,880,881,882,884,885,886,887,888,889,890,891,892,894,895,896,897,898,899,900,901,902,903,904,905,906,907,908,909,910,911,912,913,915,916,917,918,919,920,921,922,924,925,926,927,928,929,931,932,933,934,935,936,940,941,942,943,944,945,946,947,948,950,951,953,955,956,958,959,960,961,962,963,964,965,966,967,968,969,971,972,974,977,980,982,983,990,992,994,999,1000,1001,1005,1009,1010,1017,1021,1024,1025,1028,1036,1039,1044,1045,1046,1048,1049,1051,1052,1061,1062,1066,1070,1071,1073,1076,1078,1079,1084,1085,1088,1089,1091,1092,1093,1094,1095,1096,1097,1098,1099,1101,1103,1105,1107,1112,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,1125,1126,1127,1128,1129,1130,1131,1133,1134,1135,1136,1137,1140,1148,1154,1156,1157,1158,1159,1162,1163,1164,1165,1166,1167,1168,1169,1170,1173,1174,1176,1177,1178,1179,1182,1183,1185,1186,1187,1189,1191,1195,1197,1203,1206,1212,1213,1214,1215,1216,1220,1221,1223,1225,1227,1229,1232,1235,1236,1237,1238,1239,1240,1243,1244,1246,1247,1251,1252);
		String invitersIds = "103,103,103,103,103,174,181,181,181,181,181,128,128,128,128,128,190,200,200,200,200,200,202,202,202,208,221,222,222,222,222,222,223,223,223,223,223,239,239,239,239,239,239,241,241,241,241,241,241,283,283,283,283,283,283,334,334,334,334,334,348,348,348,348,348,392,392,392,374,374,374,374,374,409,409,409,409,409,415,415,415,415,415,336,336,336,336,336,446,446,446,446,446,390,390,390,390,390,463,463,463,463,463,475,475,475,475,475,445,445,445,445,445,336,336,336,336,336,336,336,487,487,487,487,487,494,494,494,494,494,495,495,495,495,495,495,495,495,495,495,505,505,505,505,505,588,588,588,588,588,336,336,336,336,336,336,336,336,601,601,601,601,601,336,625,625,625,625,625,728,728,728,728,728,729,729,729,729,729,712,712,712,712,712,466,466,466,466,466,466,623,623,623,623,623,759,759,759,759,759,757,757,757,757,757,779,779,779,779,779,779,791,791,791,791,791,794,794,794,794,794,798,752,752,752,752,752,752,793,793,793,793,793,813,813,813,813,813,828,828,828,828,828,801,801,801,801,801,840,840,840,840,840,841,841,841,841,841,841,857,857,857,857,857,859,859,859,859,859,859,864,864,864,864,864,864,818,818,818,818,818,877,877,877,877,877,881,881,881,881,881,905,905,905,905,905,901,901,901,901,901,916,916,916,916,916,920,920,825,825,825,825,825,941,941,941,941,941,941,942,942,942,942,942,944,944,944,944,944,955,955,955,955,955,977,977,977,977,977,1005,1005,1005,1005,1005,1010,1010,1010,1010,1010,1010,1010,1010,1010,1017,1017,1017,1017,1017,1048,1048,1048,1048,1048,692,692,692,692,692,912,912,912,912,912,1103,1103,1103,1103,1103,970,970,970,970,970,970,970,981,1165,1165,1165,1165,1165,1183,1183,1183,1183,1183,1183,1223,1223,1223,1223,1223,1167,1167,1167,1167,1167";
		
		theIds = invitersIds.split(",");
		uniqueIds.clear();
		
		Arrays.asList(theIds).stream().forEach(uniqueIds::add);
		
		uniqueIds.stream().forEach(System.out::println);
	}
	
	

	
}
